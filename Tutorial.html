

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tutorial &mdash; NetWork 0.1-alpha documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1-alpha',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="NetWork 0.1-alpha documentation" href="index.html" />
    <link rel="next" title="IPC and concurrency control tools" href="IPCTools.html" />
    <link rel="prev" title="Welcome to NetWork’s documentation!" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="IPCTools.html" title="IPC and concurrency control tools"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to NetWork’s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">NetWork 0.1-alpha documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<p>This tutorial will introduce you to the basic features of NetWork - creating a workgroup, giving it tasks to run,
getting results and states of running tasks.</p>
<p>Notes:</p>
<blockquote>
<div><ul class="simple">
<li>In this tutorial and in the documentation, the term &#8216;user&#8217; is often mentioned, it does not stand for the human</li>
</ul>
<p>user of your program, it stands for the program that uses the NetWork framework and its tools (the program that you
write)</p>
<ul class="simple">
<li>English is not my native language, I&#8217;ve tried to make this tutorial gramatically correct but errors can hapen.</li>
</ul>
</div></blockquote>
<div class="section" id="prepration">
<h2>Prepration<a class="headerlink" href="#prepration" title="Permalink to this headline">¶</a></h2>
<p>Before starting your program you need a group of at least two computers, one computer will be the master, the program
you write will run on it, the others are workers they will run a server that will receive instructions from the master,
all of them must be able to communicate over a network. Make sure that port <em>32151</em> is opened on the firewall on every
computer.</p>
<p>On each worker you need to run a server, just run the program server.py located in the root of the NetWork folder.
Once started it will wait for the master to register and send orders.</p>
</div>
<div class="section" id="writing-your-distributed-program">
<h2>Writing your distributed program<a class="headerlink" href="#writing-your-distributed-program" title="Permalink to this headline">¶</a></h2>
<p>Once you&#8217;ve set up the workers, you can create and run your distributed program from the master.</p>
<div class="section" id="creating-a-workgroup">
<h3>Creating a workgroup<a class="headerlink" href="#creating-a-workgroup" title="Permalink to this headline">¶</a></h3>
<p>The key part of the program is an instance of <a class="reference internal" href="NetWork.workgroup.html#NetWork.workgroup.Workgroup" title="NetWork.workgroup.Workgroup"><tt class="xref py py-class docutils literal"><span class="pre">Workgroup</span></tt></a> class, you control
everything from this object. It&#8217;s constructor takes an iterable (list, tuple, whatever) of worker IPs like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">w</span><span class="o">=</span><span class="n">Workgroup</span><span class="p">([</span><span class="s">&quot;192.168.1.25&quot;</span><span class="p">,</span> <span class="s">&quot;192.168.1.26&quot;</span><span class="p">,</span> <span class="s">&quot;192.168.1.27&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>It tries to contact each of the IPs and if it succeeds it adds the address to the workgroup, when you give it tasks
to execute it will send it to one of the computers in the list.
The workgroup is not ready yet, it has two internal processes the <tt class="docutils literal"><span class="pre">dispatcher</span></tt> and <tt class="docutils literal"><span class="pre">networkListener</span></tt> that
receive messages from workers and handle them, they need to be started in order for the workgroup to be fully
operational.
The easiest way to star them is to call the <a class="reference internal" href="NetWork.workgroup.html#NetWork.workgroup.Workgroup.startServing" title="NetWork.workgroup.Workgroup.startServing"><tt class="xref py py-meth docutils literal"><span class="pre">startServing</span></tt></a>
method of the workgroup, the method will start them and you can use all facilities of the workgroup, when you&#8217;re
done, call the <a class="reference internal" href="NetWork.workgroup.html#NetWork.workgroup.Workgroup.stopServing" title="NetWork.workgroup.Workgroup.stopServing"><tt class="xref py py-meth docutils literal"><span class="pre">stopServing</span></tt></a> method to ensure that they are
closed.
This method however is inelegant and doesn&#8217;t ensure proper cleanup in case of an exception, it&#8217;s better to use
the <tt class="docutils literal"><span class="pre">with</span></tt> statement, it&#8217;ll ensure that the workgroup is closed properly when the program exits, normally or
abruptly.
Here&#8217;s how to do it both ways:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">w</span><span class="o">=</span><span class="n">Workgroup</span><span class="p">([</span><span class="s">&quot;192.168.1.25&quot;</span><span class="p">,</span> <span class="s">&quot;192.168.1.26&quot;</span><span class="p">,</span> <span class="s">&quot;192.168.1.27&quot;</span><span class="p">])</span>
<span class="n">w</span><span class="o">.</span><span class="n">startServing</span><span class="p">()</span>
<span class="n">w</span><span class="o">.</span><span class="n">doSomething</span><span class="p">()</span>
<span class="n">w</span><span class="o">.</span><span class="n">stopServing</span><span class="p">()</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">Workgroup</span><span class="p">([</span><span class="s">&quot;192.168.1.25&quot;</span><span class="p">,</span> <span class="s">&quot;192.168.1.26&quot;</span><span class="p">,</span> <span class="s">&quot;192.168.1.27&quot;</span><span class="p">])</span> <span class="k">as</span> <span class="n">w</span><span class="p">:</span>
    <span class="n">w</span><span class="o">.</span><span class="n">doSomething</span><span class="p">()</span>
</pre></div>
</div>
<p>Use the second method if you can.</p>
</div>
<div class="section" id="giving-it-something-to-execute">
<h3>Giving it something to execute<a class="headerlink" href="#giving-it-something-to-execute" title="Permalink to this headline">¶</a></h3>
<p>To give the workgroup a task to execute, use it&#8217;s <a class="reference internal" href="NetWork.workgroup.html#NetWork.workgroup.Workgroup.submit" title="NetWork.workgroup.Workgroup.submit"><tt class="xref py py-meth docutils literal"><span class="pre">submit</span></tt></a> method, it
takes 3 arguments, the last two are optional:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">handler</span><span class="o">=</span><span class="n">w</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">some_function</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;tuple&quot;</span><span class="p">,</span> <span class="s">&quot;of&quot;</span><span class="p">,</span> <span class="s">&quot;args&quot;</span><span class="p">),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;A dict&quot;</span><span class="p">:</span><span class="s">&quot;Of arguments&quot;</span><span class="p">})</span>
</pre></div>
</div>
<p>First argument is a function to be executed in the new task, the second optional argument is a tuple of positional
arguments that will be given to the function, the third optional argument is a dictionary of keyword arguments given
to the function.
The <a class="reference internal" href="NetWork.workgroup.html#NetWork.workgroup.Workgroup.submit" title="NetWork.workgroup.Workgroup.submit"><tt class="xref py py-meth docutils literal"><span class="pre">submit</span></tt></a> method returns an instance of
<a class="reference internal" href="NetWork.task.html#NetWork.task.TaskHandler" title="NetWork.task.TaskHandler"><tt class="xref py py-class docutils literal"><span class="pre">TaskHandler</span></tt></a>, which is use to control a running tasks. The handler has methods
for getting the return value, terminating, checking exceptions etc.
In this turorial we will use two methods, <a class="reference internal" href="NetWork.task.html#NetWork.task.TaskHandler.result" title="NetWork.task.TaskHandler.result"><tt class="xref py py-meth docutils literal"><span class="pre">result</span></tt></a> and
<a class="reference internal" href="NetWork.task.html#NetWork.task.TaskHandler.running" title="NetWork.task.TaskHandler.running"><tt class="xref py py-meth docutils literal"><span class="pre">running</span></tt></a>, for other methods see the documentation of
<a class="reference internal" href="NetWork.task.html#NetWork.task.TaskHandler" title="NetWork.task.TaskHandler"><tt class="xref py py-class docutils literal"><span class="pre">TaskHandler</span></tt></a> class.
Here is a program that gives three tasks to the workgroup, waits for them to finish and gets the results</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">NetWork.workgroup</span> <span class="kn">import</span> <span class="n">Workgroup</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="k">with</span> <span class="n">Workgroup</span><span class="p">([</span><span class="s">&quot;192.168.1.25&quot;</span><span class="p">,</span> <span class="s">&quot;192.168.1.26&quot;</span><span class="p">,</span> <span class="s">&quot;192.168.1.27&quot;</span><span class="p">])</span> <span class="k">as</span> <span class="n">w</span><span class="p">:</span>
    <span class="n">handler1</span><span class="o">=</span><span class="n">w</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">long_running_function1</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">handler2</span><span class="o">=</span><span class="n">w</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">long_running_function2</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">handler3</span><span class="o">=</span><span class="n">w</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">long_running_function3</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
    <span class="k">while</span> <span class="n">handler1</span><span class="o">.</span><span class="n">running</span><span class="p">()</span> <span class="ow">or</span> <span class="n">handler2</span><span class="o">.</span><span class="n">running</span><span class="p">()</span> <span class="ow">or</span> <span class="n">handler3</span><span class="o">.</span><span class="n">running</span><span class="p">():</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">handler1</span><span class="o">.</span><span class="n">result</span><span class="p">(),</span> <span class="n">handler2</span><span class="o">.</span><span class="n">result</span><span class="p">(),</span> <span class="n">handler3</span><span class="o">.</span><span class="n">result</span><span class="p">())</span>
</pre></div>
</div>
<p>This program gives the workgroup 3 tasks and checks if they&#8217;re done every 0.5 seconds, when
<a class="reference internal" href="NetWork.task.html#NetWork.task.TaskHandler.running" title="NetWork.task.TaskHandler.running"><tt class="xref py py-meth docutils literal"><span class="pre">running</span></tt></a> method returns <tt class="docutils literal"><span class="pre">False</span></tt> the tasks are done and their results</p>
<blockquote>
<div>are obtained with the <a class="reference internal" href="NetWork.task.html#NetWork.task.TaskHandler.result" title="NetWork.task.TaskHandler.result"><tt class="xref py py-meth docutils literal"><span class="pre">result</span></tt></a> medod. Because we have 3 computers the
execution time should theoretically be up to 3 times shorter than running these on a single computer. This method
of waiting is used just for demonstration, the proper way would be to use <a class="reference internal" href="NetWork.event.html"><em>events</em></a> but that is
beyond the scope of this beginner tutorial.</div></blockquote>
</div>
<div class="section" id="what-next">
<h3>What next<a class="headerlink" href="#what-next" title="Permalink to this headline">¶</a></h3>
<p>You&#8217;ve learned the basics of using NetWork, but it&#8217;s real advantage is in the tools it offers. for more information
see the pages on <a class="reference internal" href="IPCTools.html"><em>IPC and concurrency control tools</em></a> and <a class="reference internal" href="py-modindex.html"><em>Modules index</em></a>.
You can also learn about the Inner workings of the framework.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorial</a><ul>
<li><a class="reference internal" href="#prepration">Prepration</a></li>
<li><a class="reference internal" href="#writing-your-distributed-program">Writing your distributed program</a><ul>
<li><a class="reference internal" href="#creating-a-workgroup">Creating a workgroup</a></li>
<li><a class="reference internal" href="#giving-it-something-to-execute">Giving it something to execute</a></li>
<li><a class="reference internal" href="#what-next">What next</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to NetWork&#8217;s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="IPCTools.html"
                        title="next chapter">IPC and concurrency control tools</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/Tutorial.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="IPCTools.html" title="IPC and concurrency control tools"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to NetWork’s documentation!"
             >previous</a> |</li>
        <li><a href="index.html">NetWork 0.1-alpha documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Nikola Pavlović.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>